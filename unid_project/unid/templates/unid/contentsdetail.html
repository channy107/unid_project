
{% extends 'unid/navigationbar.html' %}
{% load static %}
{% block content %}
<!-- Page Content -->
<link href="{% static 'unid/css/index.css' %}" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Noto+Sans+KR:300,400,500,700&amp;subset=korean" rel="stylesheet">

<style>
ul {
    margin: 0;
	padding: 0;
	border: 0;
	font-size: 100%;
	font: inherit;
	vertical-align: baseline;
    list-style: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: '';
	content: none;
}
}
.img-replace {
  /* replace text with an image */
  display: inline-block;
  overflow: hidden;
  text-indent: 100%;
  color: transparent;
  white-space: nowrap;
}

.cd-nugget-info {
  text-align: center;
  position: absolute;
  width: 100%;
  height: 50px;
  line-height: 50px;
  bottom: 0;
  left: 0;
}
.cd-nugget-info a {
  position: relative;
  font-size: 14px;
  color: #5e6e8d;
  -webkit-transition: all 0.2s;
  -moz-transition: all 0.2s;
  transition: all 0.2s;
}
.no-touch .cd-nugget-info a:hover {
  opacity: .8;
}
.cd-nugget-info span {
  vertical-align: middle;
  display: inline-block;
}
.cd-nugget-info span svg {
  display: block;
}
.cd-nugget-info .cd-nugget-info-arrow {
  fill: #5e6e8d;
}

/* --------------------------------

Main components

-------------------------------- */
header {
  height: 200px;
  line-height: 200px;
  text-align: center;
  background-color: #5e6e8d;
  color: #FFF;
}
header h1 {
  font-size: 20px;
  font-size: 1.25rem;
}

.cd-popup-trigger {
  display: block;
  width: 150px;
  height: 40px;
  /* line-height: 50px; */
  text-align: center;
  color: #FFF;
  font-size: 14px;
  font-size: 0.95rem;
  border-radius: 0.5em;
  background: #fb2323d1;
  box-shadow: 0 3px 0 rgba(0, 0, 0, 0.07);
}
@media only screen and (min-width: 1170px) {
  .cd-popup-trigger {
    margin: 1em auto;
  }
}

/* --------------------------------

xpopup

-------------------------------- */
.cd-popup {
  position: fixed;
  left: 0;
  top: 0;
  height: 100%;
  width: 100%;
  background-color: rgba(94, 110, 141, 0.9);
  opacity: 0;
  visibility: hidden;
  -webkit-transition: opacity 0.3s 0s, visibility 0s 0.3s;
  -moz-transition: opacity 0.3s 0s, visibility 0s 0.3s;
  transition: opacity 0.3s 0s, visibility 0s 0.3s;
}
.cd-popup.is-visible {
  opacity: 1;
  visibility: visible;
  -webkit-transition: opacity 0.3s 0s, visibility 0s 0s;
  -moz-transition: opacity 0.3s 0s, visibility 0s 0s;
  transition: opacity 0.3s 0s, visibility 0s 0s;
}

.cd-popup-container {
  position: relative;
  width: 90%;
  max-width: 400px;
  margin: 4em auto;
  background: #FFF;
  border-radius: .25em .25em .4em .4em;
  text-align: center;
  box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
  -webkit-transform: translateY(-40px);
  -moz-transform: translateY(-40px);
  -ms-transform: translateY(-40px);
  -o-transform: translateY(-40px);
  transform: translateY(-40px);
  /* Force Hardware Acceleration in WebKit */
  -webkit-backface-visibility: hidden;
  -webkit-transition-property: -webkit-transform;
  -moz-transition-property: -moz-transform;
  transition-property: transform;
  -webkit-transition-duration: 0.3s;
  -moz-transition-duration: 0.3s;
  transition-duration: 0.3s;
  padding: 30px;
}
.cd-popup-container p {
  padding: 3em 1em;
}
.cd-popup-container .cd-buttons:after {
  content: "";
  display: table;
  clear: both;
}
.cd-popup-container .cd-buttons li {
  float: left;
  width: 50%;
  padding: 5px 20px 10px 20px;
  list-style: none;
}
.cd-popup-container .cd-buttons a {
  display: block;
  height: 40px;
  line-height: 40px;
  text-transform: uppercase;
  color: #FFF;
  -webkit-transition: background-color 0.2s;
  -moz-transition: background-color 0.2s;
  transition: background-color 0.2s;
}
.cd-popup-container .cd-buttons li:first-child a {
  background: #b6bece;
  border-radius: 0 0 0 .25em;
}
.popuprow1 {
    font-weight: bold;
    padding: 30px 20px 50px;
}
.popuprow2 {
    color: grey;
    padding: 0 0 30px 0;
    font-size: 0.95rem;
    text-align: left;
}
.popuprow3 {
    color: grey;
    padding: 0 0 30px 0;
    font-size: 0.8rem;
}

.no-touch .cd-popup-container .cd-buttons li:first-child a:hover {
  background-color: #c5ccd8;
}
.cd-popup-container .cd-buttons li:last-child a {
  background: #fc7169;
  border-radius: 0 0 .25em 0;
}
.no-touch .cd-popup-container .cd-buttons li:last-child a:hover {
  background-color: #fc8982;
}
.cd-popup-container .cd-popup-close {
  position: absolute;
  top: 8px;
  right: 8px;
  width: 30px;
  height: 30px;
}
.cd-popup-container .cd-popup-close::before, .cd-popup-container .cd-popup-close::after {
  content: '';
  position: absolute;
  top: 12px;
  width: 14px;
  height: 3px;
  background-color: #8f9cb5;
}
.cd-popup-container .cd-popup-close::before {
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
  transform: rotate(45deg);
  left: 8px;
}
.cd-popup-container .cd-popup-close::after {
  -webkit-transform: rotate(-45deg);
  -moz-transform: rotate(-45deg);
  -ms-transform: rotate(-45deg);
  -o-transform: rotate(-45deg);
  transform: rotate(-45deg);
  right: 8px;
}
.is-visible .cd-popup-container {
  -webkit-transform: translateY(0);
  -moz-transform: translateY(0);
  -ms-transform: translateY(0);
  -o-transform: translateY(0);
  transform: translateY(0);
  color: black;
}
.popupinformationsrow {
    flex-direction: row;
    display: inline;
}
.popupinformations {
    color: black;
    font-weight: bold;
    float: right;
}

@media only screen and (min-width: 1170px) {
  .cd-popup-container {
    margin: 16em auto;
  }


</style>
<div class="container1">
    <!-- contents InFo -->
    <div class="rows">
        <div class="row">
            <div class="contents-info">
                <div class="contents-kind">
                    {{ contents.category }}
                </div>
                <h2 align="center">
                    <b> {{ contents.title }}</b>
                </h2>
                <hr size="10" align="center" width=20% noshade="noshade" />
                <p align="center" size ="5">
                    <img src="{% static 'unid/icon/profle-icon.png' %}" border="0" width="35" height="35">   {{ contents.writeremail }}  3일전</p>
                <p align="center" size ="5">
                    <img src="{% static 'unid/icon/PDF-icon.png' %}" border="0" width="20" height="20">{{ contents.fileinfo }}
                    <img src="{% static 'unid/icon/page-icon.png' %}" border="0" width="20" height="20">{{ contents.totalpages }}page
                    <img src="{% static 'unid/icon/disk-icon.png' %}" border="0" width="20" height="20">파일크기
                </p>
            </div>
        </div>
        <!-- preview -->
        <div class="row">
                <div id="carouselExampleIndicators" class="carousel slide my-4" data-ride="carousel">
                    <ol class="carousel-indicators">
                        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                    </ol>
                    <div class="carousel-inner" role="listbox">
                        <div class="carousel-item active">
                            <img class="d-block img-fluid" src="ftp://210.107.78.157/contents/2019-01-03/0.8394321006163772.jpg" alt="First slide">
                        </div>
                        <div class="carousel-item">
                            <img class="d-block img-fluid" src="http://placehold.it/1000x1050" alt="Second slide">
                        </div>
                        <div class="carousel-item">
                            <img class="d-block img-fluid" src="http://placehold.it/1000x1050" alt="Third slide">
                        </div>
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                </div>
        </div>
        <!-- detail of contents -->
        <div class="row">
            <div class="contents-detail">
                <p>컨텐츠 정보</p>
                <p>저자 : {{ contents.authorinfo }}</p>

                <p>저작시기 : {{ contents.publisheddate }}</p>

                <p>소개글: {{ contents.intro }}</p>

                <p>목차:</p>
                      {{ contents.index }}

                <p>본문내용: {{ contents.contents }}</p>

                <p>비고: {{ contents.reference }}</p>
            </div>
        </div>
        <!-- payment -->
        <div class="row">
            <div class="contents-payment">
                <div>
                    <p> <img src="{% static 'unid/icon/dollar-icon.png' %}" border="0" width="30" height="30">{{ contents.price }} </p>

                    <button type="button" class="cd-popup-trigger" id='enrollcontents'> 
                        <img src="{% static 'unid/icon/download-icon.png' %}" border="0" width="30" height="30">
                        Download 
                    </button>
                    <div class="cd-popup" role="alert">
                        <div class="cd-popup-container">
                            <div class="popuprow1">
                                <h4>컨텐츠를 등록하시겠습니까?</h4>
                            </div>
                            <div class="popuprow2">
                                <ul id='popupinfo'>

                                </ul>
                            </div>
                            <div class="popuprow3">
                                컨텐츠는 저자가 책정한 판매가에 따라 구매자가 지불한 니드코인을 통해 보상되며 이더리움 네트워크 사정에 의해 처리속도가 지연될 수 있습니다.
                            </div>

                            <ul class="cd-buttons">
                                <li><a href="#0" class="cd-popup-no">No</a></li>
                                <li><a href="#0" class="cd-popup-yes">Yes</a></li>
                            </ul>
                            <a href="#0" class="cd-popup-close img-replace"></a>
                        </div> <!-- cd-popup-container -->
                    </div> <!-- cd-popup -->
                    {% comment %} <button type="button" class="btn btn-primary btn-md cd-popup-trigger" color="red">
                         <img src="{% static 'unid/icon/download-icon.png' %}" border="0" width="30" height="30">Download
                    </button>
                    <div class="cd-popup" role="alert">
                        <div class="cd-popup-container">
                            <div class="popuprow1">
                                <h4>컨텐츠를 다운받으시겠습니까?</h4>
                            </div>
                            <div class="popuprow2">
                                <ul id='popupinfo'>

                                </ul>
                            </div>
                            <div class="popuprow3">
                                컨텐츠는 저자가 책정한 판매가에 따라 구매자가 지불한 니드코인을 통해 보상되며 이더리움 네트워크 사정에 의해 처리속도가 지연될 수 있습니다.
                            </div>

                            <ul class="cd-buttons">
                                <li><a href="#0" class="cd-popup-no" id="enrollyes" onclick="document.getElementById('myform').submit()">Yes</a></li>
                                <li><a href="#0" class="cd-popup-yes">No</a></li>
                            </ul>
                            <a href="#0" class="cd-popup-close img-replace"></a>
                        </div> <!-- cd-popup-container -->
                    </div> <!-- cd-popup --> {% endcomment %}
                </div>
            </div>
        </div>

        <div class="row">
            <div class="contents-tag">
                <div>
                    <img src="{% static 'unid/icon/tag-icon.png' %}" border="0" width="20" height="20">
                    <span>{{ contents.tags }}</span>
                </div>
            </div>
        </div>


        <!-- replyment -->
        <div class="row">
            <div class="contents-reply">
                <img src="{% static 'unid/icon/heart-icon.png' %}" border="0" width="20" height="20">
                10
                <img src="{% static 'unid/icon/wordballoon-icon.png' %}" border="0" width="20" height="20">
                2
                <hr size="10" align="left"  width=670px noshade="noshade" style="color: #b3afaf54;"/>
                <div class="reply-list">
                    <div class="reply">
                        <div class="reply-picture">
                            <img src="{% static 'unid/icon/profle-icon.png' %}" border="0" width="32" height="59">
                        </div>
                        <div class="reply-id">
                            <span>injh9900</span>
                        </div>
                        <div class="reply-date">
                            <span>며칠전</span>
                        </div>
                        <div class="reply-text">
                            <p>좋은 자료 감사합니다 잘 사용하겠습니다.</p>
                        </div>
                    </div>
                    <div class="reply">
                        <div class="reply-picture">
                            <img src="{% static 'unid/icon/profle-icon.png' %}" border="0" width="32" height="59">
                        </div>
                        <div class="reply-id">
                            <span>injh9900</span>
                        </div>
                        <div class="reply-date">
                            <span>며칠전</span>
                        </div>
                        <div class="reply-text">
                            <p>좋은 자료 감사합니다 잘 사용하겠습니다.</p>
                        </div>
                    </div>
                    <div class="reply">
                        <div class="reply-picture">
                            <img src="{% static 'unid/icon/profle-icon.png' %}" border="0" width="32" height="59">
                        </div>
                        <div class="reply-id">
                            <span>injh9900</span>
                        </div>
                        <div class="reply-date">
                            <span>며칠전</span>
                        </div>
                        <div class="reply-text">
                            <p>좋은 자료 감사합니다 잘 사용하겠습니다.</p>
                        </div>
                    </div>
                    <div class="reply">
                        <div class="reply-picture">
                            <img src="{% static 'unid/icon/profle-icon.png' %}" border="0" width="32" height="59">
                        </div>
                        <div class="reply-id">
                            <span>injh9900</span>
                        </div>
                        <div class="reply-date">
                            <span>며칠전</span>
                        </div>
                        <div class="reply-text">
                            <p>좋은 자료 감사합니다 잘 사용하겠습니다.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <form class="input-reply">
                <textarea rows="5" cols="90"> 유니드계정으로 로그인하고 댓글을 입력해보세요!</textarea>
                <p></p>
                <input type="submit" value="댓글작성" style="margin:0 0 0 600px;">
            </form>
        </div>
    </div>
</div>


<script src="http://code.jquery.com/jquery-3.1.1.min.js"></script>
<script>


    jQuery(document).ready(function($){
        //open popup
        $('.cd-popup-trigger').on('click', function(event){
            event.preventDefault();
            $('.cd-popup').addClass('is-visible');
   
        });
        
        //close popup
        $('.cd-popup').on('click', function(event){
            if( $(event.target).is('.cd-popup-close') || $(event.target).is('.cd-popup') || $(event.target).is('.cd-popup-no')) {
                event.preventDefault();
                $(this).removeClass('is-visible');
            }
        });
        //close popup when clicking the esc keyboard button
        $(document).keyup(function(event){
            if(event.which=='27'){
                $('.cd-popup').removeClass('is-visible');
            }

        });
    
    });

    var WEB3 = require('web3');
    var web3 = new WEB3();
    web3.setProvider(new web3.providers.HttpProvider("http://localhost:8545"));

    var contentsmasterContract = web3.eth.contract([{"constant":true,"inputs":[{"name":"","type":"address"}],"name":"contents","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"name","type":"string"},{"name":"price","type":"uint32"}],"name":"addContents","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getContentsAddressList","outputs":[{"name":"contentsAddressList","type":"address[]"}],"payable":false,"stateMutability":"view","type":"function"},{"anonymous":false,"inputs":[{"indexed":false,"name":"name","type":"string"}],"name":"EventAddContents","type":"event"}]);


    let cc = contentsmasterContract.at( "0xbf5f1204ba8ee3bc0096459e9b80099d4fee2a7a" );

    var contentsContract = web3.eth.contract([{"constant":false,"inputs":[],"name":"countUp","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"getDownloadCount","outputs":[{"name":"","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getContentsPrice","outputs":[{"name":"","type":"uint32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getContentsName","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"name","type":"string"},{"name":"price","type":"uint32"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"name":"count","type":"uint32"}],"name":"EventCountUp","type":"event"}]);

    $(function() {
        $('#enrollyes').click(function() {
            let contentsprice = $('#inputprice').val();
            let contentsname = $('#user_files').val();
            cc.addContents (
                contentsname,
                contentsprice,
                { from: web3.eth.coinbase, gas: 1000000 },
                function(err, res) {
                    if (!err) {
                        console.log(res);
                    } else {
                        console.error(err);
                    }
                }
            );       
        });
    });

</script>
{% endblock %}

